$(document).ready(function(){}),define(["require","app/controllers/DigitalGreenPageController","app/view-controllers/CollectionViewController","app/view-controllers/CollectionMostFiltersViewController","app/view-controllers/news/NewsFeedViewController","app/view-controllers/FeaturedCollectionViewController","jquery","libs/NCarousel/NCarousel","libs/external/swfobject/swfobject"],function(e){var t=e("app/controllers/DigitalGreenPageController"),n=e("app/view-controllers/CollectionViewController"),r=e("app/view-controllers/CollectionMostFiltersViewController"),i=e("app/view-controllers/news/NewsFeedViewController"),s=e("app/view-controllers/FeaturedCollectionViewController"),o=e("jquery"),u=e("libs/NCarousel/NCarousel");e("libs/external/swfobject/swfobject");var a=t.extend({constructor:function(e,t){this.base(e,t);var n=this._references;return n.collectionViewController.setCollectionsPerPage(12).setCollectionsPerRow(4).setVideosPerDrawer(5),n.collectionMostFiltersViewController.setActiveFilter("-likes"),this._getNewsFeed(),this._getFeaturedCollection(),this},_initReferences:function(e){this.base(e);var t=this._references,a=o(".js-collections-wrapper"),f=o(".js-news-feed-wrapper"),l=o(".js-featured-collection-wrapper"),c=Util.Cookie.get("language__name");t.collectionViewController=new n(a,c),t.collectionMostFiltersViewController=new r(a),t.newsFeedViewController=new i(f),t.FeaturedCollectionViewController=new s(l,c),t.$mainCarouselWrapper=o("#main-carousel"),t.mainCarousel=new u(t.$mainCarouselWrapper,{transition:"slide",autoPlay:!0,autoPlayDelay:8e3}),t.$playButton=o(".play-button")},_initEvents:function(){this.base();var e=this._references,t=this._boundFunctions;t.onOrderChanged=this._onOrderChanged.bind(this),e.collectionMostFiltersViewController.on("orderChanged",t.onOrderChanged),t.onNewsFeedUpdated=this._onNewsFeedUpdated.bind(this),e.newsFeedViewController.on("newsFeedUpdated",t.onNewsFeedUpdated),t.onPlayButtonClick=this._onVideoPlayButtonClick.bind(this),e.$playButton.on("click",t.onPlayButtonClick)},_onOrderChanged:function(e){this._references.collectionViewController.setInputParam("order_by",e)},_getCollections:function(){this._references.collectionViewController.getCollections()},_getNewsFeed:function(){this._references.newsFeedViewController.getNewsItems()},_getFeaturedCollection:function(){this._references.FeaturedCollectionViewController.getFeaturedCollection()},_onNewsFeedUpdated:function(e){this._references.newsFeedViewController.updateTotalCount(e.totalCount),this._references.newsFeedViewController.addToCurrentCount(e.addedCount),this._references.newsFeedViewController.updateNewsItemPaginationDisplay()},_initVideoPlayer:function(){var e="ICxPW-OoSFI",t={allowScriptAccess:"always"},n={id:"player","class":"main-carousel-video-player"};swfobject.embedSWF("http://www.youtube.com/v/"+e+"?enablejsapi=1&playerapiid=ytplayer&version=3","player","1024","424","8",null,null,t,n),window.onYouTubePlayerReady=this._onYouTubePlayerReady.bind(this),$("#video-img > div").not("#player").each(function(e,t){$(t).hide()}),$("#player").show()},_onYouTubePlayerReady:function(){window.onYouTubePlayerReady=undefined;var e=o("#player").get(0);this._references.videoPlayer=e,window.onYouTubePlayerStateChange=this._onYouTubePlayerStateChange.bind(this),e.addEventListener("onStateChange","onYouTubePlayerStateChange"),e.playVideo()},_onYouTubePlayerStateChange:function(e){e==0&&($("#player").hide(),$("#video-img > div").not("#player").each(function(e,t){$(t).show()}))},_onVideoPlayButtonClick:function(e){this._initVideoPlayer()},destroy:function(){this.base()}});return a});