var databasev1={id:"coco-database",description:"The offline database for COCO",migrations:[{version:1,migrate:function(e,t){e.db.createObjectStore("country",{autoIncrement:!0}),e.db.createObjectStore("village",{autoIncrement:!0}),e.db.createObjectStore("video",{autoIncrement:!0}),e.db.createObjectStore("persongroup",{autoIncrement:!0}),e.db.createObjectStore("screening",{autoIncrement:!0}),e.db.createObjectStore("person",{autoIncrement:!0}),e.db.createObjectStore("personadoptvideo",{autoIncrement:!0}),e.db.createObjectStore("animator",{autoIncrement:!0}),console.log("indexeddb database created"),t()}}]},village_offline_model=Backbone.Model.extend({remove:function(){this.destroy()},database:databasev1,storeName:"village"}),village_online_model=Backbone.Model.extend({remove:function(){this.destroy()},sync:Backbone.ajaxSync,url:function(){return this.id?"/api/v1/village/"+this.id+"/":"/api/v1/village/?limit=0"}}),village_online_collection=Backbone.Collection.extend({model:village_online_model,url:"/api/v1/village/?limit=0",sync:Backbone.ajaxSync,parse:function(e){return e.objects}}),village_offline_collection=Backbone.Collection.extend({model:village_offline_model,database:databasev1,storeName:"village"}),video_offline_model=Backbone.Model.extend({remove:function(){this.destroy()},database:databasev1,storeName:"video"}),video_online_model=Backbone.Model.extend({remove:function(){this.destroy()},sync:Backbone.ajaxSync,url:function(){return this.id?"/api/v1/video/"+this.id+"/":"/api/v1/video/?limit=0"}}),video_online_collection=Backbone.Collection.extend({model:video_online_model,url:"/api/v1/video/?limit=0",sync:Backbone.ajaxSync,parse:function(e){return e.objects}}),video_offline_collection=Backbone.Collection.extend({model:video_offline_model,database:databasev1,storeName:"video"}),persongroup_offline_model=Backbone.Model.extend({remove:function(){this.destroy()},database:databasev1,storeName:"persongroup"}),persongroup_online_model=Backbone.Model.extend({remove:function(){this.destroy()},sync:Backbone.ajaxSync,url:function(){return this.id?"/api/v1/group/"+this.id+"/":"/api/v1/group/?limit=0"}}),persongroup_online_collection=Backbone.Collection.extend({model:persongroup_online_model,url:"/api/v1/group/?limit=0",sync:Backbone.ajaxSync,parse:function(e){return e.objects}}),persongroup_offline_collection=Backbone.Collection.extend({model:persongroup_offline_model,database:databasev1,storeName:"persongroup",by_village:function(e){return this.filter(function(t){return t.get("village").id==e})}}),screening_offline_model=Backbone.Model.extend({remove:function(){this.destroy()},database:databasev1,storeName:"screening"}),screening_online_model=Backbone.Model.extend({remove:function(){this.destroy()},sync:Backbone.ajaxSync,url:function(){return this.id?"/api/v1/screening/"+this.id+"/":"/api/v1/screening/?limit=0"}}),screening_online_collection=Backbone.Collection.extend({model:screening_online_model,url:"/api/v1/screening/?limit=0",sync:Backbone.ajaxSync,parse:function(e){return e.objects}}),screening_offline_collection=Backbone.Collection.extend({model:screening_offline_model,database:databasev1,storeName:"screening"}),person_offline_model=Backbone.Model.extend({remove:function(){this.destroy()},database:databasev1,storeName:"person"}),person_online_model=Backbone.Model.extend({remove:function(){this.destroy()},sync:Backbone.ajaxSync,url:function(){return this.id?"/api/v1/person/"+this.id+"/":"/api/v1/person/"},save:function(e,t){return console.log("SAVE OVERRIDE: cleaning data"),this.get("age")==""&&this.set("age",null),this.get("land_holdings")==""&&this.set("land_holdings",null),this.get("village")?this.set("village","/api/v1/village/"+this.get("village")+"/"):this.set("village",null),this.get("group")?this.set("group","/api/v1/group/"+this.get("group")+"/"):this.set("group",null),console.log("ADD/EDIT: saving this on server"+JSON.stringify(this)),Backbone.Model.prototype.save.call(this,e,t)}}),person_online_collection=Backbone.Collection.extend({model:person_online_model,url:"/api/v1/person/",sync:Backbone.ajaxSync,parse:function(e){return e.objects}}),person_offline_collection=Backbone.Collection.extend({model:person_offline_model,database:databasev1,storeName:"person"}),personadoptvideo_offline_model=Backbone.Model.extend({remove:function(){this.destroy()},database:databasev1,storeName:"personadoptvideo"}),personadoptvideo_online_model=Backbone.Model.extend({remove:function(){this.destroy()},sync:Backbone.ajaxSync,url:function(){return this.id?"/api/v1/personadoptvideo/"+this.id+"/":"/api/v1/personadoptvideo/?limit=0"}}),personadoptvideo_online_collection=Backbone.Collection.extend({model:personadoptvideo_online_model,url:"/api/v1/personadoptvideo/?limit=0",sync:Backbone.ajaxSync,parse:function(e){return e.objects}}),personadoptvideo_offline_collection=Backbone.Collection.extend({model:personadoptvideo_offline_model,database:databasev1,storeName:"personadoptvideo"}),animator_offline_model=Backbone.Model.extend({remove:function(){this.destroy()},database:databasev1,storeName:"animator"}),animator_online_model=Backbone.Model.extend({remove:function(){this.destroy()},sync:Backbone.ajaxSync,url:function(){return this.id?"/api/v1/animator/"+this.id+"/":"/api/v1/animator/?limit=0"}}),animator_online_collection=Backbone.Collection.extend({model:animator_online_model,url:"/api/v1/animator/?limit=0",sync:Backbone.ajaxSync,parse:function(e){return e.objects}}),animator_offline_collection=Backbone.Collection.extend({model:animator_offline_model,database:databasev1,storeName:"animator"});